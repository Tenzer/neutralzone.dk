<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <title>Neutral Zone</title>
    <style type='text/css'>
      header, ul#tweets, footer {
        margin: 0 auto;
        width: 900px;
      }

      ul#tweets li {
        margin-bottom: 10px;
      }

      footer {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <header>
      <img src='images/banner.png' alt='Neutral Zone - Live tweets from Danish American football teams' />
    </header>

    <ul id='tweets'></ul>

    <footer>
      <p id='credits'>This page is made by <a href='http://tenzer.dk/'>Jeppe Toustrup</a> and <a href='http://teige.dk/'>Nicklas Teige</a>.</p>
      <p id='status'>Not connected to server.</p>
    </footer>

    <script src='http://neutralzone.dk:3000/socket.io/socket.io.v0.9.6.js'></script>
    <script src='fuzzytime.js'></script>
    <script>
      var socket = io.connect('http://neutralzone.dk:3000');
      var tweets_element = document.getElementById('tweets');

      socket.on('users', function usersUpdate (data) {
        document.getElementById('status').innerHTML = 'Connected to server. ' +
          'Current users: ' + data.count + '.';
      });

      socket.on('tweet', function tweetReceived (data) {
        var item = document.createElement('li');
        item.setAttribute('id', data.tweetId);
        item.innerHTML = data.html;
        tweets_element.insertBefore(item, tweets_element.firstChild);
      });

      socket.on('delete', function tweetDeleted (data) {
        var tweet = document.getElementById(data.tweetId);
        if (tweet) {
          tweet.parentNode.removeChild(tweet);
        }
      });

      socket.on('error', function errorDetected (error) {
        document.getElementById('status').innerHTML = 'Lost connection to server.';
        console.log(error);
      });

      socket.on('time', function timeReceived (data) {
        goFuzzy(data.now);
      });
    </script>
  </body>
</html>
